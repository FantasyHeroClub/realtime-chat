{"version":3,"sources":["../src/ColorHeatmap.js"],"names":["CustomPropTypes","interpolatorFromType","type","toLowerCase","makeColorScale","domain","colors","interpolator","length","isString","range","interpolate","ColorHeatmap","nextProps","nextState","shouldUpdate","props","data","xScale","yScale","value","x","xEnd","y","yEnd","rectStyle","rectClassName","valueAccessor","colorScale","valueDomain","times","scale","schemeCategory10","map","d","i","color","style","fill","className","key","xScaleType","yScaleType","Component","propTypes","array","isRequired","valueOrAccessor","func","string","oneOfType","object","defaultProps"],"mappings":"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","file":"ColorHeatmap.js","sourcesContent":["import React from 'react';\nimport _ from 'lodash';\nimport {scaleLinear, interpolateHcl, interpolateHsl, interpolateLab, interpolateRgb} from 'd3';\nimport invariant from 'invariant';\nimport PropTypes from 'prop-types';\n\nimport * as CustomPropTypes from './utils/CustomPropTypes';\nimport {makeAccessor2, getValue, domainFromData, domainFromRangeData} from './utils/Data';\nimport {dataTypeFromScaleType} from './utils/Scale';\nimport xyPropsEqual from './utils/xyPropsEqual';\n\nimport RangeRect from './RangeRect';\n\n\nfunction interpolatorFromType(type) {\n  switch(type.toLowerCase()) {\n    case 'hcl': return interpolateHcl;\n    case 'hsl': return interpolateHsl;\n    case 'lab': return interpolateLab;\n    case 'rgb': return interpolateRgb;\n    default: return interpolateHsl;\n  }\n}\n\nfunction makeColorScale(domain, colors, interpolator) {\n  invariant(domain.length === colors.length, 'ColorHeatmap makeColorScale: domain.length should equal colors.length');\n\n  if(_.isString(interpolator))\n    interpolator = interpolatorFromType(interpolator);\n\n  return scaleLinear()\n    .domain(domain)\n    .range(colors)\n    .interpolate(interpolator);\n}\n\nexport default class ColorHeatmap extends React.Component {\n  static propTypes = {\n    /**\n     * data array - should be 1D array of all grid values\n     * (if you have a 2D array, _.flatten it)\n     */\n    data: PropTypes.array.isRequired,\n    value: CustomPropTypes.valueOrAccessor,\n    x: CustomPropTypes.valueOrAccessor,\n    xEnd: CustomPropTypes.valueOrAccessor,\n    y: CustomPropTypes.valueOrAccessor,\n    yEnd: CustomPropTypes.valueOrAccessor,\n    /**\n     * D3 scale for X axis - provided by XYPlot\n     */\n    xScale: PropTypes.func,\n    /**\n     * D3 scale for Y axis - provided by XYPlot\n     */\n    yScale: PropTypes.func,\n    /**\n     * a custom d3 color scale may be passed...\n     */\n    colorScale: PropTypes.func,\n    /**\n     * ...or else one will be constructed from colors, colorStops and interpolator\n     */\n    colors: PropTypes.array,\n    valueDomain: PropTypes.array,\n    interpolator: PropTypes.string,\n    rectStyle: PropTypes.oneOfType([PropTypes.object, PropTypes.func]),\n    rectClassName: PropTypes.oneOfType([PropTypes.string, PropTypes.func])\n  };\n  static defaultProps = {\n    interpolator: 'lab',\n    rectStyle: {},\n    rectClassName: ''\n  };\n\n  static getDomain(props) {\n    const {xScaleType, yScaleType, data, x, xEnd, y, yEnd} = props;\n    return {\n      x: domainFromRangeData(data, makeAccessor2(x), makeAccessor2(xEnd), dataTypeFromScaleType(xScaleType)),\n      y: domainFromRangeData(data, makeAccessor2(y), makeAccessor2(yEnd), dataTypeFromScaleType(yScaleType))\n    };\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    const shouldUpdate = !xyPropsEqual(this.props, nextProps, ['colors', 'valueDomain']);\n    return shouldUpdate;\n  }\n\n  render() {\n    const {data, xScale, yScale, value, x, xEnd, y, yEnd, interpolator, rectStyle, rectClassName} = this.props;\n    const valueAccessor = makeAccessor2(value);\n    let colorScale;\n\n    if(this.props.colorScale) colorScale = this.props.colorScale;\n    else {\n      const valueDomain = this.props.valueDomain || domainFromData(data, valueAccessor);\n      const colors = this.props.colors || (\n        (valueDomain.length === 2) ?\n          ['#000000', '#ffffff'] :\n          _.times(valueDomain.length, scale.schemeCategory10().domain(_.range(10)))\n      );\n      colorScale = makeColorScale(valueDomain, colors, interpolator);\n    }\n\n    return <g className=\"color-heatmap-chart\">\n      {data.map((d, i) => {\n        const color = colorScale(valueAccessor(d));\n        const style = {...getValue(rectStyle, d, i), fill: color};\n        const className = `heatmap-rect ${getValue(rectClassName, d, i)}`;\n        const key = `heatmap-rect-${i}`;\n        return <RangeRect\n          x={getValue(x, d, i)}\n          xEnd={getValue(xEnd, d, i)}\n          y={getValue(y, d, i)}\n          yEnd={getValue(yEnd, d, i)}\n          {...{xScale, yScale, style, className, key}}\n        />;\n      })}\n    </g>;\n  }\n}\n"]}