{"version":3,"sources":["../src/RangeBarChart.js"],"names":["CustomPropTypes","RangeBarChart","nextProps","nextState","shouldUpdate","props","scale","data","horizontal","getX","getXEnd","getY","getYEnd","barThickness","barClassName","barStyle","getClass","accessors","x","y","endAccessors","map","d","i","callback","get","eventName","isFunction","partial","onMouseEnter","onMouseMove","onMouseLeave","barProps","thickness","className","style","thisBarProps","xValue","yValue","key","scaleType","rangeAxis","rangeStartAccessor","rangeEndAccessor","rangeDataType","domain","dataDomain","P","k","first","last","sortBy","domainHead","domainTail","dataDomainHead","dataDomainTail","clamp","spacingTail","spacingHead","top","right","bottom","left","Component","propTypes","xyObjectOf","func","isRequired","array","bool","getter","number","string","object","onMouseEnterBar","onMouseMoveBar","onMouseLeaveBar","defaultProps"],"mappings":"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","file":"RangeBarChart.js","sourcesContent":["import React from 'react';\nimport _ from 'lodash';\nimport invariant from 'invariant';\nimport PropTypes from 'prop-types';\nimport * as CustomPropTypes from './utils/CustomPropTypes';\nimport {hasXYScales, dataTypeFromScaleType} from './utils/Scale';\nimport {makeAccessor, domainFromRangeData, domainFromData, getDataDomainByAxis} from './utils/Data';\nimport xyPropsEqual from './utils/xyPropsEqual';\nimport Bar from './Bar';\n\nexport default class RangeBarChart extends React.Component {\n  static propTypes = {\n    scale: CustomPropTypes.xyObjectOf(PropTypes.func.isRequired),\n    data: PropTypes.array,\n    horizontal: PropTypes.bool,\n\n    getX: CustomPropTypes.getter,\n    getXEnd: CustomPropTypes.getter,\n    getY: CustomPropTypes.getter,\n    getYEnd: CustomPropTypes.getter,\n\n    barThickness: PropTypes.number,\n    barClassName: PropTypes.string,\n    barStyle: PropTypes.object,\n    getClass: CustomPropTypes.getter,\n\n    onMouseEnterBar: PropTypes.func,\n    onMouseMoveBar: PropTypes.func,\n    onMouseLeaveBar: PropTypes.func\n  };\n  static defaultProps = {\n    data: [],\n    horizontal: false,\n    barThickness: 8,\n    barClassName: '',\n    barStyle: {}\n  };\n\n  static getDomain(props) {\n    const {scaleType, horizontal, data, getX, getXEnd, getY, getYEnd} = props;\n\n    // only have to specify range axis domain, other axis uses default domainFromData\n    const rangeAxis = horizontal ? 'x' : 'y';\n    const rangeStartAccessor = horizontal ? makeAccessor(getX) : makeAccessor(getY);\n    const rangeEndAccessor = horizontal ? makeAccessor(getXEnd) : makeAccessor(getYEnd);\n    const rangeDataType = dataTypeFromScaleType(scaleType[rangeAxis]);\n\n    return {\n      [rangeAxis]: domainFromRangeData(data, rangeStartAccessor, rangeEndAccessor, rangeDataType)\n    };\n  }\n  static getSpacing(props) {\n    const {barThickness, horizontal, scale, data, domain} = props;\n    const dataDomain = getDataDomainByAxis(props);\n    const P = barThickness / 2; //padding\n    const k = horizontal ? 'y' : 'x';\n    //find the edges of the tick domain, and map them through the scale function\n    const [domainHead, domainTail] = _([_.first(domain[k]), _.last(domain[k])]).map(scale[k]).sortBy(); //sort the pixel values return by the domain extents\n    //find the edges of the data domain, and map them through the scale function\n    const [dataDomainHead, dataDomainTail] = _([_.first(dataDomain[k]), _.last(dataDomain[k])]).map(scale[k]).sortBy(); //sort the pixel values return by the domain extents\n    //find the neccessary spacing (based on bar width) to push the bars completely inside the tick domain\n    const [spacingTail, spacingHead] = [_.clamp(P - (domainTail - dataDomainTail), 0, P), _.clamp(P - (dataDomainHead - domainHead), 0, P)];\n    if(horizontal){\n      return {top: spacingHead, right: 0, bottom: spacingTail, left: 0}\n    } else {\n      return {top: 0, right: spacingTail, bottom: 0, left: spacingHead}\n    }\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    const shouldUpdate = !xyPropsEqual(this.props, nextProps, ['barStyle']);\n    return shouldUpdate;\n  }\n\n  render() {\n    const {scale, data, horizontal, getX, getXEnd, getY, getYEnd, barThickness, barClassName, barStyle, getClass} = this.props;\n    invariant(hasXYScales(scale), `RangeBarChart.props.scale.x and scale.y must both be valid d3 scales`);\n    // invariant(hasOneOfTwo(getXEnd, getYEnd), `RangeBarChart expects a getXEnd *or* getYEnd prop, but not both.`);\n\n    const accessors = {x: makeAccessor(getX), y: makeAccessor(getY)};\n    const endAccessors = {x: makeAccessor(getXEnd), y: makeAccessor(getYEnd)};\n    \n\n\n    return <g>\n      {data.map((d, i) => {\n\n        const [onMouseEnter, onMouseMove, onMouseLeave] =\n          ['onMouseEnterBar', 'onMouseMoveBar', 'onMouseLeaveBar'].map(eventName => {\n\n            // partially apply this bar's data point as 2nd callback argument\n            const callback = _.get(this.props, eventName);\n            return _.isFunction(callback) ? _.partial(callback, _, d) : null;\n        });\n\n        const barProps = {\n          scale,\n          thickness: barThickness,\n          className: `chart-bar ${barClassName} ${getClass ? getClass(d) : ''}`,\n          style: barStyle\n        };\n\n        const thisBarProps = {\n          xValue: accessors.x(d),\n          yValue: accessors.y(d),\n          key: `chart-bar-${i}`,\n          onMouseEnter, \n          onMouseMove, \n          onMouseLeave,\n          ...barProps\n        };\n\n        return horizontal ?\n          <Bar xEndValue={endAccessors.x(d)} {...thisBarProps} /> :\n          <Bar yEndValue={endAccessors.y(d)} {...thisBarProps} />;\n      })}\n    </g>;\n  }\n}\n"]}