{"version":3,"sources":["../src/RangeBarChart.js"],"names":["CustomPropTypes","RangeBarChart","props","scale","data","horizontal","getX","getXEnd","getY","getYEnd","barThickness","barClassName","barStyle","getClass","accessors","x","y","endAccessors","map","d","i","callback","_","get","eventName","isFunction","partial","onMouseEnter","onMouseMove","onMouseLeave","barProps","thickness","className","style","thisBarProps","xValue","yValue","key","scaleType","rangeAxis","rangeStartAccessor","rangeEndAccessor","rangeDataType","domain","dataDomain","P","k","first","last","sortBy","domainHead","domainTail","dataDomainHead","dataDomainTail","clamp","spacingTail","spacingHead","top","right","bottom","left","Component","propTypes","xyObjectOf","func","isRequired","array","bool","getter","number","string","object","onMouseEnterBar","onMouseMoveBar","onMouseLeaveBar","defaultProps"],"mappings":";;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;IAAYA,e;;AACZ;;AACA;;AACA;;;;;;;;;;;;;;;;IAEqBC,a;;;;;;;;;;;6BA0DV;AAAA;;AAAA,mBACyG,KAAKC,KAD9G;AAAA,UACAC,KADA,UACAA,KADA;AAAA,UACOC,IADP,UACOA,IADP;AAAA,UACaC,UADb,UACaA,UADb;AAAA,UACyBC,IADzB,UACyBA,IADzB;AAAA,UAC+BC,OAD/B,UAC+BA,OAD/B;AAAA,UACwCC,IADxC,UACwCA,IADxC;AAAA,UAC8CC,OAD9C,UAC8CA,OAD9C;AAAA,UACuDC,YADvD,UACuDA,YADvD;AAAA,UACqEC,YADrE,UACqEA,YADrE;AAAA,UACmFC,QADnF,UACmFA,QADnF;AAAA,UAC6FC,QAD7F,UAC6FA,QAD7F;;AAEP,+BAAU,wBAAYV,KAAZ,CAAV;AACA;;AAEA,UAAMW,YAAY,EAACC,GAAG,wBAAaT,IAAb,CAAJ,EAAwBU,GAAG,wBAAaR,IAAb,CAA3B,EAAlB;AACA,UAAMS,eAAe,EAACF,GAAG,wBAAaR,OAAb,CAAJ,EAA2BS,GAAG,wBAAaP,OAAb,CAA9B,EAArB;;AAIA,aAAO;AAAA;AAAA;AACJL,aAAKc,GAAL,CAAS,UAACC,CAAD,EAAIC,CAAJ,EAAU;AAAA,qBAGhB,CAAC,iBAAD,EAAoB,gBAApB,EAAsC,iBAAtC,EAAyDF,GAAzD,CAA6D,qBAAa;;AAExE;AACA,gBAAMG,WAAWC,EAAEC,GAAF,CAAM,OAAKrB,KAAX,EAAkBsB,SAAlB,CAAjB;AACA,mBAAOF,EAAEG,UAAF,CAAaJ,QAAb,IAAyBC,EAAEI,OAAF,CAAUL,QAAV,EAAoBC,CAApB,EAAuBH,CAAvB,CAAzB,GAAqD,IAA5D;AACH,WALC,CAHgB;AAAA;AAAA,cAEXQ,YAFW;AAAA,cAEGC,WAFH;AAAA,cAEgBC,YAFhB;;AAUlB,cAAMC,WAAW;AACf3B,wBADe;AAEf4B,uBAAWrB,YAFI;AAGfsB,sCAAwBrB,YAAxB,UAAwCE,WAAWA,SAASM,CAAT,CAAX,GAAyB,EAAjE,CAHe;AAIfc,mBAAOrB;AAJQ,WAAjB;;AAOA,cAAMsB;AACJC,oBAAQrB,UAAUC,CAAV,CAAYI,CAAZ,CADJ;AAEJiB,oBAAQtB,UAAUE,CAAV,CAAYG,CAAZ,CAFJ;AAGJkB,gCAAkBjB,CAHd;AAIJO,sCAJI;AAKJC,oCALI;AAMJC;AANI,aAODC,QAPC,CAAN;;AAUA,iBAAOzB,aACL,wDAAK,WAAWY,aAAaF,CAAb,CAAeI,CAAf,CAAhB,IAAuCe,YAAvC,EADK,GAEL,wDAAK,WAAWjB,aAAaD,CAAb,CAAeG,CAAf,CAAhB,IAAuCe,YAAvC,EAFF;AAGD,SA9BA;AADI,OAAP;AAiCD;;;8BAzEgBhC,K,EAAO;AAAA,UACfoC,SADe,GAC8CpC,KAD9C,CACfoC,SADe;AAAA,UACJjC,UADI,GAC8CH,KAD9C,CACJG,UADI;AAAA,UACQD,IADR,GAC8CF,KAD9C,CACQE,IADR;AAAA,UACcE,IADd,GAC8CJ,KAD9C,CACcI,IADd;AAAA,UACoBC,OADpB,GAC8CL,KAD9C,CACoBK,OADpB;AAAA,UAC6BC,IAD7B,GAC8CN,KAD9C,CAC6BM,IAD7B;AAAA,UACmCC,OADnC,GAC8CP,KAD9C,CACmCO,OADnC;;AAGtB;;AACA,UAAM8B,YAAYlC,aAAa,GAAb,GAAmB,GAArC;AACA,UAAMmC,qBAAqBnC,aAAa,wBAAaC,IAAb,CAAb,GAAkC,wBAAaE,IAAb,CAA7D;AACA,UAAMiC,mBAAmBpC,aAAa,wBAAaE,OAAb,CAAb,GAAqC,wBAAaE,OAAb,CAA9D;AACA,UAAMiC,gBAAgB,kCAAsBJ,UAAUC,SAAV,CAAtB,CAAtB;;AAEA,iCACGA,SADH,EACe,+BAAoBnC,IAApB,EAA0BoC,kBAA1B,EAA8CC,gBAA9C,EAAgEC,aAAhE,CADf;AAGD;;;+BACiBxC,K,EAAO;AAAA,UAChBQ,YADgB,GACiCR,KADjC,CAChBQ,YADgB;AAAA,UACFL,UADE,GACiCH,KADjC,CACFG,UADE;AAAA,UACUF,KADV,GACiCD,KADjC,CACUC,KADV;AAAA,UACiBC,IADjB,GACiCF,KADjC,CACiBE,IADjB;AAAA,UACuBuC,MADvB,GACiCzC,KADjC,CACuByC,MADvB;;AAEvB,UAAMC,aAAa,+BAAoB1C,KAApB,CAAnB;AACA,UAAM2C,IAAInC,eAAe,CAAzB,CAHuB,CAGK;AAC5B,UAAMoC,IAAIzC,aAAa,GAAb,GAAmB,GAA7B;AACA;;AALuB,yBAMUiB,EAAE,CAACA,EAAEyB,KAAF,CAAQJ,OAAOG,CAAP,CAAR,CAAD,EAAqBxB,EAAE0B,IAAF,CAAOL,OAAOG,CAAP,CAAP,CAArB,CAAF,EAA2C5B,GAA3C,CAA+Cf,MAAM2C,CAAN,CAA/C,EAAyDG,MAAzD,EANV;AAAA;AAAA,UAMhBC,UANgB;AAAA,UAMJC,UANI,qBAM6E;AACpG;;;AAPuB,0BAQkB7B,EAAE,CAACA,EAAEyB,KAAF,CAAQH,WAAWE,CAAX,CAAR,CAAD,EAAyBxB,EAAE0B,IAAF,CAAOJ,WAAWE,CAAX,CAAP,CAAzB,CAAF,EAAmD5B,GAAnD,CAAuDf,MAAM2C,CAAN,CAAvD,EAAiEG,MAAjE,EARlB;AAAA;AAAA,UAQhBG,cARgB;AAAA,UAQAC,cARA,qBAQ6F;AACpH;;;AATuB,kBAUY,CAAC/B,EAAEgC,KAAF,CAAQT,KAAKM,aAAaE,cAAlB,CAAR,EAA2C,CAA3C,EAA8CR,CAA9C,CAAD,EAAmDvB,EAAEgC,KAAF,CAAQT,KAAKO,iBAAiBF,UAAtB,CAAR,EAA2C,CAA3C,EAA8CL,CAA9C,CAAnD,CAVZ;AAAA,UAUhBU,WAVgB;AAAA,UAUHC,WAVG;;AAWvB,UAAGnD,UAAH,EAAc;AACZ,eAAO,EAACoD,KAAKD,WAAN,EAAmBE,OAAO,CAA1B,EAA6BC,QAAQJ,WAArC,EAAkDK,MAAM,CAAxD,EAAP;AACD,OAFD,MAEO;AACL,eAAO,EAACH,KAAK,CAAN,EAASC,OAAOH,WAAhB,EAA6BI,QAAQ,CAArC,EAAwCC,MAAMJ,WAA9C,EAAP;AACD;AACF;;;;EAzDwC,gBAAMK,S;;AAA5B5D,a,CACZ6D,S,GAAY;AACjB3D,SAAOH,gBAAgB+D,UAAhB,CAA2B,oBAAUC,IAAV,CAAeC,UAA1C,CADU;AAEjB7D,QAAM,oBAAU8D,KAFC;AAGjB7D,cAAY,oBAAU8D,IAHL;;AAKjB7D,QAAMN,gBAAgBoE,MALL;AAMjB7D,WAASP,gBAAgBoE,MANR;AAOjB5D,QAAMR,gBAAgBoE,MAPL;AAQjB3D,WAAST,gBAAgBoE,MARR;;AAUjB1D,gBAAc,oBAAU2D,MAVP;AAWjB1D,gBAAc,oBAAU2D,MAXP;AAYjB1D,YAAU,oBAAU2D,MAZH;AAajB1D,YAAUb,gBAAgBoE,MAbT;;AAejBI,mBAAiB,oBAAUR,IAfV;AAgBjBS,kBAAgB,oBAAUT,IAhBT;AAiBjBU,mBAAiB,oBAAUV;AAjBV,C;AADA/D,a,CAoBZ0E,Y,GAAe;AACpBvE,QAAM,EADc;AAEpBC,cAAY,KAFQ;AAGpBK,gBAAc,CAHM;AAIpBC,gBAAc,EAJM;AAKpBC,YAAU;AALU,C;kBApBHX,a","file":"RangeBarChart.js","sourcesContent":["import React from 'react';\nimport invariant from 'invariant';\nimport PropTypes from 'prop-types';\nimport * as CustomPropTypes from './utils/CustomPropTypes';\nimport {hasXYScales, dataTypeFromScaleType} from './utils/Scale';\nimport {makeAccessor, domainFromRangeData, domainFromData, getDataDomainByAxis} from './utils/Data';\nimport Bar from './Bar';\n\nexport default class RangeBarChart extends React.Component {\n  static propTypes = {\n    scale: CustomPropTypes.xyObjectOf(PropTypes.func.isRequired),\n    data: PropTypes.array,\n    horizontal: PropTypes.bool,\n\n    getX: CustomPropTypes.getter,\n    getXEnd: CustomPropTypes.getter,\n    getY: CustomPropTypes.getter,\n    getYEnd: CustomPropTypes.getter,\n\n    barThickness: PropTypes.number,\n    barClassName: PropTypes.string,\n    barStyle: PropTypes.object,\n    getClass: CustomPropTypes.getter,\n\n    onMouseEnterBar: PropTypes.func,\n    onMouseMoveBar: PropTypes.func,\n    onMouseLeaveBar: PropTypes.func\n  };\n  static defaultProps = {\n    data: [],\n    horizontal: false,\n    barThickness: 8,\n    barClassName: '',\n    barStyle: {}\n  };\n\n  static getDomain(props) {\n    const {scaleType, horizontal, data, getX, getXEnd, getY, getYEnd} = props;\n\n    // only have to specify range axis domain, other axis uses default domainFromData\n    const rangeAxis = horizontal ? 'x' : 'y';\n    const rangeStartAccessor = horizontal ? makeAccessor(getX) : makeAccessor(getY);\n    const rangeEndAccessor = horizontal ? makeAccessor(getXEnd) : makeAccessor(getYEnd);\n    const rangeDataType = dataTypeFromScaleType(scaleType[rangeAxis]);\n\n    return {\n      [rangeAxis]: domainFromRangeData(data, rangeStartAccessor, rangeEndAccessor, rangeDataType)\n    };\n  }\n  static getSpacing(props) {\n    const {barThickness, horizontal, scale, data, domain} = props;\n    const dataDomain = getDataDomainByAxis(props);\n    const P = barThickness / 2; //padding\n    const k = horizontal ? 'y' : 'x';\n    //find the edges of the tick domain, and map them through the scale function\n    const [domainHead, domainTail] = _([_.first(domain[k]), _.last(domain[k])]).map(scale[k]).sortBy(); //sort the pixel values return by the domain extents\n    //find the edges of the data domain, and map them through the scale function\n    const [dataDomainHead, dataDomainTail] = _([_.first(dataDomain[k]), _.last(dataDomain[k])]).map(scale[k]).sortBy(); //sort the pixel values return by the domain extents\n    //find the neccessary spacing (based on bar width) to push the bars completely inside the tick domain\n    const [spacingTail, spacingHead] = [_.clamp(P - (domainTail - dataDomainTail), 0, P), _.clamp(P - (dataDomainHead - domainHead), 0, P)];\n    if(horizontal){\n      return {top: spacingHead, right: 0, bottom: spacingTail, left: 0}\n    } else {\n      return {top: 0, right: spacingTail, bottom: 0, left: spacingHead}\n    }\n  }\n  render() {\n    const {scale, data, horizontal, getX, getXEnd, getY, getYEnd, barThickness, barClassName, barStyle, getClass} = this.props;\n    invariant(hasXYScales(scale), `RangeBarChart.props.scale.x and scale.y must both be valid d3 scales`);\n    // invariant(hasOneOfTwo(getXEnd, getYEnd), `RangeBarChart expects a getXEnd *or* getYEnd prop, but not both.`);\n\n    const accessors = {x: makeAccessor(getX), y: makeAccessor(getY)};\n    const endAccessors = {x: makeAccessor(getXEnd), y: makeAccessor(getYEnd)};\n    \n\n\n    return <g>\n      {data.map((d, i) => {\n\n        const [onMouseEnter, onMouseMove, onMouseLeave] =\n          ['onMouseEnterBar', 'onMouseMoveBar', 'onMouseLeaveBar'].map(eventName => {\n\n            // partially apply this bar's data point as 2nd callback argument\n            const callback = _.get(this.props, eventName);\n            return _.isFunction(callback) ? _.partial(callback, _, d) : null;\n        });\n\n        const barProps = {\n          scale,\n          thickness: barThickness,\n          className: `chart-bar ${barClassName} ${getClass ? getClass(d) : ''}`,\n          style: barStyle\n        };\n\n        const thisBarProps = {\n          xValue: accessors.x(d),\n          yValue: accessors.y(d),\n          key: `chart-bar-${i}`,\n          onMouseEnter, \n          onMouseMove, \n          onMouseLeave,\n          ...barProps\n        };\n\n        return horizontal ?\n          <Bar xEndValue={endAccessors.x(d)} {...thisBarProps} /> :\n          <Bar yEndValue={endAccessors.y(d)} {...thisBarProps} />;\n      })}\n    </g>;\n  }\n}\n"]}